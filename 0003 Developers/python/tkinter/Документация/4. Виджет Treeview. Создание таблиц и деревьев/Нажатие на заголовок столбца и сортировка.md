С помощью параметра command метода `heading()` можно привязать к заголовку некоторую функцию, которая будет вызываться по нажатию на заголовок.

[?](https://metanit.com/python/tkinter/4.3.php#)

<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="py plain">treeview.heading(имя_заголовка, command</code><code class="py keyword">=</code><code class="py plain">функция)</code></div></div></td></tr></tbody></table>

Рассмотрим на примере сортировки:

[?](https://metanit.com/python/tkinter/4.3.php#)

<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="py keyword">from</code> <code class="py plain">tkinter </code><code class="py keyword">import</code> <code class="py keyword">*</code></div><div class="line number2 index1 alt1"><code class="py keyword">from</code> <code class="py plain">tkinter </code><code class="py keyword">import</code> <code class="py plain">ttk</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="py plain">root </code><code class="py keyword">=</code> <code class="py plain">Tk()</code></div><div class="line number5 index4 alt2"><code class="py plain">root.title(</code><code class="py string">"METANIT.COM"</code><code class="py plain">)</code></div><div class="line number6 index5 alt1"><code class="py plain">root.geometry(</code><code class="py string">"250x200"</code><code class="py plain">)</code></div><div class="line number7 index6 alt2">&nbsp;</div><div class="line number8 index7 alt1"><code class="py comments"># определяем данные для отображения</code></div><div class="line number9 index8 alt2"><code class="py plain">people </code><code class="py keyword">=</code> <code class="py plain">[(</code><code class="py string">"Tom"</code><code class="py plain">, </code><code class="py value">38</code><code class="py plain">, </code><code class="py string">"tom@email.com"</code><code class="py plain">), (</code><code class="py string">"Bob"</code><code class="py plain">, </code><code class="py value">42</code><code class="py plain">, </code><code class="py string">"bob@email.com"</code><code class="py plain">), (</code><code class="py string">"Sam"</code><code class="py plain">, </code><code class="py value">28</code><code class="py plain">, </code><code class="py string">"sam@email.com"</code><code class="py plain">)]</code></div><div class="line number10 index9 alt1">&nbsp;</div><div class="line number11 index10 alt2"><code class="py comments"># определяем столбцы</code></div><div class="line number12 index11 alt1"><code class="py plain">columns </code><code class="py keyword">=</code> <code class="py plain">(</code><code class="py string">"name"</code><code class="py plain">, </code><code class="py string">"age"</code><code class="py plain">, </code><code class="py string">"email"</code><code class="py plain">)</code></div><div class="line number13 index12 alt2">&nbsp;</div><div class="line number14 index13 alt1"><code class="py plain">tree </code><code class="py keyword">=</code> <code class="py plain">ttk.Treeview(columns</code><code class="py keyword">=</code><code class="py plain">columns, show</code><code class="py keyword">=</code><code class="py string">"headings"</code><code class="py plain">)</code></div><div class="line number15 index14 alt2"><code class="py plain">tree.pack(expand</code><code class="py keyword">=</code><code class="py value">1</code><code class="py plain">, fill</code><code class="py keyword">=</code><code class="py plain">BOTH)</code></div><div class="line number16 index15 alt1">&nbsp;</div><div class="line number17 index16 alt2"><code class="py keyword">def</code> <code class="py plain">sort(col, reverse):</code></div><div class="line number18 index17 alt1"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py comments"># получаем все значения столбцов в виде отдельного списка</code></div><div class="line number19 index18 alt2"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py plain">l </code><code class="py keyword">=</code> <code class="py plain">[(tree.</code><code class="py functions">set</code><code class="py plain">(k, col), k) </code><code class="py keyword">for</code> <code class="py plain">k </code><code class="py keyword">in</code> <code class="py plain">tree.get_children("")]</code></div><div class="line number20 index19 alt1"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py comments"># сортируем список</code></div><div class="line number21 index20 alt2"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py plain">l.sort(reverse</code><code class="py keyword">=</code><code class="py plain">reverse)</code></div><div class="line number22 index21 alt1"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py comments"># переупорядочиваем значения в отсортированном порядке</code></div><div class="line number23 index22 alt2"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py keyword">for</code> <code class="py plain">index,&nbsp; (_, k) </code><code class="py keyword">in</code> <code class="py functions">enumerate</code><code class="py plain">(l):</code></div><div class="line number24 index23 alt1"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py plain">tree.move(k, "", index)</code></div><div class="line number25 index24 alt2"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py comments"># в следующий раз выполняем сортировку в обратном порядке</code></div><div class="line number26 index25 alt1"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py plain">tree.heading(col, command</code><code class="py keyword">=</code><code class="py keyword">lambda</code><code class="py plain">: sort(col, </code><code class="py keyword">not</code> <code class="py plain">reverse))</code></div><div class="line number27 index26 alt2">&nbsp;</div><div class="line number28 index27 alt1"><code class="py comments"># определяем заголовки</code></div><div class="line number29 index28 alt2"><code class="py plain">tree.heading(</code><code class="py string">"name"</code><code class="py plain">, text</code><code class="py keyword">=</code><code class="py string">"Имя"</code><code class="py plain">, anchor</code><code class="py keyword">=</code><code class="py plain">W, command</code><code class="py keyword">=</code><code class="py keyword">lambda</code><code class="py plain">: sort(</code><code class="py value">0</code><code class="py plain">, </code><code class="py color1">False</code><code class="py plain">))</code></div><div class="line number30 index29 alt1"><code class="py plain">tree.heading(</code><code class="py string">"age"</code><code class="py plain">, text</code><code class="py keyword">=</code><code class="py string">"Возраст"</code><code class="py plain">, anchor</code><code class="py keyword">=</code><code class="py plain">W, command</code><code class="py keyword">=</code><code class="py keyword">lambda</code><code class="py plain">: sort(</code><code class="py value">1</code><code class="py plain">, </code><code class="py color1">False</code><code class="py plain">))</code></div><div class="line number31 index30 alt2"><code class="py plain">tree.heading(</code><code class="py string">"email"</code><code class="py plain">, text</code><code class="py keyword">=</code><code class="py string">"Email"</code><code class="py plain">, anchor</code><code class="py keyword">=</code><code class="py plain">W, command</code><code class="py keyword">=</code><code class="py keyword">lambda</code><code class="py plain">: sort(</code><code class="py value">2</code><code class="py plain">, </code><code class="py color1">False</code><code class="py plain">))</code></div><div class="line number32 index31 alt1">&nbsp;</div><div class="line number33 index32 alt2"><code class="py plain">tree.column(</code><code class="py string">"#1"</code><code class="py plain">, stretch</code><code class="py keyword">=</code><code class="py plain">NO, width</code><code class="py keyword">=</code><code class="py value">70</code><code class="py plain">)</code></div><div class="line number34 index33 alt1"><code class="py plain">tree.column(</code><code class="py string">"#2"</code><code class="py plain">, stretch</code><code class="py keyword">=</code><code class="py plain">NO, width</code><code class="py keyword">=</code><code class="py value">60</code><code class="py plain">)</code></div><div class="line number35 index34 alt2"><code class="py plain">tree.column(</code><code class="py string">"#3"</code><code class="py plain">, stretch</code><code class="py keyword">=</code><code class="py plain">NO, width</code><code class="py keyword">=</code><code class="py value">100</code><code class="py plain">)</code></div><div class="line number36 index35 alt1">&nbsp;</div><div class="line number37 index36 alt2"><code class="py comments"># добавляем данные</code></div><div class="line number38 index37 alt1"><code class="py keyword">for</code> <code class="py plain">person </code><code class="py keyword">in</code> <code class="py plain">people:</code></div><div class="line number39 index38 alt2"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py plain">tree.insert("", END, values</code><code class="py keyword">=</code><code class="py plain">person)</code></div><div class="line number40 index39 alt1">&nbsp;</div><div class="line number41 index40 alt2"><code class="py plain">root.mainloop()</code></div></div></td></tr></tbody></table>

Как и в предыдущих примерах, виджет Treeview использует список кортежей people и представляет таблицу с тремя столбцами.

Для сортировки определена функция `sort()`, которая принимает два параметра: col(номер столбца, по которому идет сортировка) и reverse (направление сортировки - по возрастанию или убыванию)

[?](https://metanit.com/python/tkinter/4.3.php#)

<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="py keyword">def</code> <code class="py plain">sort(col, reverse):</code></div></div></td></tr></tbody></table>

Рассмотрим действие функции по этапно:

1.  При добавлениии элементов в Treeview каждому из них присваивается идентификатор. Используя идентификатор, можно получить все значения элемента в Treeview. Это необходимо, чтобы отсортировать элементы:
    
    [?](https://metanit.com/python/tkinter/4.3.php#)
    
    <table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="py plain">l </code><code class="py keyword">=</code> <code class="py plain">[(tree.</code><code class="py functions">set</code><code class="py plain">(k, col), k) </code><code class="py keyword">for</code> <code class="py plain">k </code><code class="py keyword">in</code> <code class="py plain">tree.get_children("")]</code></div></div></td></tr></tbody></table>
    
    Здесь вначале пробегаемся по всем элементам в Treeview с помощью метода `tree.get_children("")`. В метод передается пустая строка "", поскольку мы хотим получить элементы верхнего уровня (по сути строки таблицы). Соответственно переменная k здесь будет представлять идентификатор элемента
    
2.  Для каждого элемента с помощью метода set получаем с помощью идентификатора значение столбца строки:
    
    [?](https://metanit.com/python/tkinter/4.3.php#)
    
    <table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="py plain">tree.</code><code class="py functions">set</code><code class="py plain">(k, col)</code></div></div></td></tr></tbody></table>
    
    Например, если col=0 (то есть сортировка идет по имени, то вызов `tree.set(k, col)` возвращает имя ("Tom", "Bob", "Sam").
    
3.  Полученное значение помещаем в кортеж:
    
    [?](https://metanit.com/python/tkinter/4.3.php#)
    
    <table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="py plain">(tree.</code><code class="py functions">set</code><code class="py plain">(k, col), k)</code></div></div></td></tr></tbody></table>
    
4.  Из кортежей формируется список:
    
    [?](https://metanit.com/python/tkinter/4.3.php#)
    
    <table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="py plain">l </code><code class="py keyword">=</code> <code class="py plain">[(tree.</code><code class="py functions">set</code><code class="py plain">(k, col), k) </code><code class="py keyword">for</code> <code class="py plain">k </code><code class="py keyword">in</code> <code class="py plain">tree.get_children("")]</code></div></div></td></tr></tbody></table>
    
    То есть если, к примеру, сортировка идет по имени, то на выходе переменная l будет представлять список кортежей типа `[("Tom", "I001"), ("Bob", "I002"), ("Sam", "I003")]`
    
5.  Затем сортируем список с помощью встроенной метода `sort()`:
    
    [?](https://metanit.com/python/tkinter/4.3.php#)
    
    <table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="py plain">l.sort(reverse</code><code class="py keyword">=</code><code class="py plain">reverse)</code></div></div></td></tr></tbody></table>
    
    В методе указываем направление сортировки с помощью параметра `reverse`
    
6.  Список отсортирован, но на отображение данных в таблице это пока никак не повлияло. Нам надо переупорядочить строки, привести их в соответствие с отсортированным списком l. Для этого переставляем их с помощью метода `move()`:
    
    [?](https://metanit.com/python/tkinter/4.3.php#)
    
    <table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="py keyword">for</code> <code class="py plain">index,&nbsp; (_, k) </code><code class="py keyword">in</code> <code class="py functions">enumerate</code><code class="py plain">(l):</code></div><div class="line number2 index1 alt1"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py plain">tree.move(k, "", index)</code></div></div></td></tr></tbody></table>
    
    Сначала с помощью функции `enumerate()` из списка l получаем набор объектов, который состоит из индекса и собственно данных. При переборе этого набора индекс получаем в переменную index, а набор данных в кортеж `(_, k)` - первый элемент кортежа представляет имя, но здесь оно нам уже не нужно, оно использовалось на предыдущем шаге для сортировки. А второй элемент кортежа - идентификатор строки.
    
    В цикле с помощью вызова `tree.move(k, "", index)` перемещаем элемент с идентификатором k, который является элементов верхнего уровня (второй аргумент - "") на позицию с индексом index.
    
7.  На финальной стадии переустанавливаем определение заголовка:
    
    [?](https://metanit.com/python/tkinter/4.3.php#)
    
    <table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="py plain">tree.heading(col, command</code><code class="py keyword">=</code><code class="py keyword">lambda</code><code class="py plain">: sort(col, </code><code class="py keyword">not</code> <code class="py plain">reverse))</code></div></div></td></tr></tbody></table>
    
    Параметр `command` в качестве выполняемой функции получает лямбда-выражение, которое вызывает функцию sort. При этом функции передается противоположное направление сортировки. Благодаря этому при следующем нажатии на заголовок сортировка будет идти в противоположном направлении.
    

Результат работы программы:

![Сортировка и обработка нажатия на заголовок в Treeview в tkinter и python](https://metanit.com/python/tkinter/4.3.php./pics/2.89.png)